---
title: "ST 558: Project 1"
format: pdf
editor: visual
---

## Individual Steps
```{r}
#| message: false
#| warning: false
library(tidyverse)

# Step 1
EDU01a <- read_csv("data/EDU01a.csv") |>
  select(Area_name, STCOU, ends_with("D")) |>
  rename("area_name" = "Area_name")

head(EDU01a, 5)

# Step 2
long <- EDU01a |>
  pivot_longer(cols = 3:12, names_to = "survey_value", values_to = "enrollment")

head(long, 5)

# Step 3
## add year and measurement variables
long_updated <- long |> 
  mutate(short_year = as.numeric(substr(survey_value, 8, 9)), 
         year = ifelse(short_year > 25, 1900 + short_year, 2000 + short_year),
         measurement = substr(survey_value, 1, 7)) |>
  select(-short_year)
## print out the first 5 rows
head(long_updated, 5)

# Step 4
## get the county indices
county_indices <- grep(pattern = ", \\w\\w", long_updated$area_name)
## create the non-county data
state_tibble <- long_updated[-county_indices,]
## create the county data
county_tibble <- long_updated[county_indices,]
## add a class to the county tibble
class(county_tibble) <- c("county", class(county_tibble))
## print out the first 10 rows
head(state_tibble, 10)
head(county_tibble, 10)

# Step 5
## add state column
county_tibble<- county_tibble |>
  mutate(state = substr(area_name, nchar(area_name) - 1, nchar(area_name)))

# Step 6
division_map <- c("CONNECTICUT" = "New England",
                  "MAINE" = "New England",
                  "MASSACHUSETTS" = "New England",
                  "NEW HAMPSHIRE" = "New England",
                  "RHODE ISLAND" = "New England",
                  "VERMONT" = "New England",
                  "NEW JERSEY" = "Mid-Atlantic",
                  "NEW YORK" = "Mid-Atlantic",
                  "PENNSYLVANIA" = "Mid-Atlantic",
                  "ILLINOIS" = "East North Central",
                  "INDIANA" = "East North Central",
                  "MICHIGAN" = "East North Central",
                  "OHIO" = "East North Central",
                  "WISCONSIN" = "East North Central",
                  "IOWA" = "West North Central",
                  "KANSAS" = "West North Central",
                  "MINNESOTA" = "West North Central",
                  "MISSOURI" = "West North Central",
                  "NEBRASKA" = "West North Central",
                  "NORTH DAKOTA" = "West North Central",
                  "SOUTH DAKOTA" = "West North Central",
                  "DELAWARE" = "South Atlantic",
                  "District of Columbia" = "South Atlantic",
                  "FLORIDA" = "South Atlantic",
                  "GEORGIA" = "South Atlantic",
                  "MARYLAND" = "South Atlantic",
                  "NORTH CAROLINA" = "South Atlantic",
                  "SOUTH CAROLINA" = "South Atlantic",
                  "VIRGINIA" = "South Atlantic",
                  "WEST VIRGINIA" = "South Atlantic",
                  "ALABAMA" = "East South Central",
                  "KENTUCKY" = "East South Central",
                  "MISSISSIPPI" = "East South Central",
                  "TENNESSEE" = "East South Central",
                  "ARKANSAS" = "West South Central",
                  "LOUISIANA" = "West South Central",
                  "OKLAHOMA" = "West South Central",
                  "TEXAS" = "West South Central",
                  "ARIZONA" = "Mountain",
                  "COLORADO" = "Mountain",
                  "IDAHO" = "Mountain",
                  "MONTANA" = "Mountain",
                  "NEVADA" = "Mountain",
                  "NEW MEXICO" = "Mountain",
                  "UTAH" = "Mountain",
                  "WYOMING" = "Mountain",
                  "ALASKA" = "Pacific",
                  "CALIFORNIA" = "Pacific",
                  "HAWAII" = "Pacific",
                  "OREGON" = "Pacific",
                  "WASHINGTON" = "Pacific")
```

## Function 1: Read and Convert Data

## Function 2: Parsing the Data and Creating New Varaiables

## Function 3: County Level

## Function 4: Non-County Level

## Function 5: Returning Two Final Tibbles

## Wrapper Function

## Combine Function

## Custom Plot Function

## Putting it All Together

### Data Processing Function

### Data Combining Function

### Plot Function on State

### Plot Function on County

### Repeating the Process For Additional Data Sets

### Plot Function